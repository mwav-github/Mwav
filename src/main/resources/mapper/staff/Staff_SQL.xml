<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- #은 ' ' string // $ 은 숫자 ' ' 없음 -->
<mapper namespace="staff">
	
	<!-- 
<resultMap type="net.admins.dao.StaffVO" id="StaffVO">
	  <id property="staff_id" column="staff_id" />
	  <result column="stfLoginId" property="stfLoginId" />
	 <result column="stfLoginPw" property="stfLoginPw" />
	 <result column="stfNumber" property="stfNumber" />
	 <result column="stfName" property="stf"Name />
	 <result column="stfNickname" property="stfNickname" />
	 <result column="stfBranch" property="stfBranch" />
	 <result column="stfDeptName" property="stfDeptName" />
	 <result column="stfClass" property="stfClass" />
	 <result column="stfSubJobs" property="stfSubJobs" />
	 <result column="stfPhone" property="stfPhone" />
	 <result column="stfCellularP" property="stfCellularP" />
	 <result column="stfExtNbr" property="stfExtNbr" />
	 <result column="stfEmail" property="stfEmail" />
	 <result column="stfSsn1" property="stfSsn1" />
	 <result column="stfSsn2" property="stfSsn2" />
	 <result column="stfZipCode" property="stfZipCode" />
	 <result column="stfAddress" property="stfAddress" />
	 <result column="stfMessengerName" property="stfMessengerName" />
	 <result column="stfMessengerId" property="stfMessengerId" />
	 <result column="stfHomepage" property="stfHomepage" />
	 <result column="stfMark" property="stfMark" />
	 <result column="stfMark" property="stfMark" />
	 <result column="stfLevel" property="stfLevel" />
	 <result column="stfBusinessPic" property="stf" />
	 <result column="stf" property="stf" />
	 <result column="stf" property="stf" />
	 <result column="stf" property="stf" />
	 <result column="stf" property="stf" />
 </resultMap> -->

	

	<select id="selectNextStfPk" resultType="int">
		<![CDATA[
	       select IFNULL(max(staff_id+1) , 100000) AS staff_id from Staff_tbl
		]]>
	</select>
	
	<select id="selectOneStfLoginIdCheck" parameterType="string" resultType="string">
		<![CDATA[
	      select stfLoginId from Staff_tbl where stfLoginId = #{stfLoginId};
		]]>
	</select>
	
	<!-- /*========================================등록========================================*/ -->
	<insert id="insertStfForm" parameterType="hashmap">
		<![CDATA[
		INSERT INTO Staff_tbl 
		SELECT IFNULL(max(staff_id)+1,101), #{stfLoginId}, #{stfLoginPw}, #{stfNumber}, #{stfName}, #{stfNickname}, #{stfBranch}, #{stfDeptName}, #{stfClass}, #{stfSubJobs}, #{stfPhone}, #{stfCellularP}, #{stfExtNbr},#{stfEmail},#{stfSsn1},#{stfSsn2},#{stfZipcode},#{stfAddress},#{stfMessengerName},#{stfMessengerId},#{stfHomepage},#{stfMark},#{stfLevel},#{stfBusinessPic},#{stfAvataImage},#{stfData},#{stfPoint},#{stfPointAc},#{stfJoinDt},#{stfDeleteDt},NOW(),#{stfUpdateDt},#{stfRecentLoginDt},#{stfIpAddress} FROM Staff_tbl
		]]>
	</insert>
	
	
	
	<!--/*========================================리스트(SelctOne, SelectList 순)========================================*/  -->
	
	<select id="selectOneGetTotalCount" resultType="int">
	<![CDATA[
	   select count(*) from Staff_tbl
	]]>
	</select>
	
	<select id="selectListStfList" parameterType="hashmap" resultType="hashmap">
	<![CDATA[
	select c.* from (select @ROWNUM := @ROWNUM + 1 AS ROWNUM, a.* from (select * from Staff_tbl order by staff_id) a,  (SELECT @ROWNUM := 0) R ) c where c.ROWNUM >= #{startRow} and c.ROWNUM <= #{endRow}
	]]>
	</select>
	
	
	<!-- /*========================================보기========================================*/ -->
	<select id="selectStfView" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
	      select * from Staff_tbl where staff_id= #{staff_id}
		]]>
	</select>
		
	<select id="updateStfForm" parameterType="hashmap"  resultType="hashmap">
		<![CDATA[
	       select * from Staff_tbl where staff_id= #{staff_id}
		]]>
	</select>
	
    <update id="updateProStfForm" parameterType="hashmap"  >
		<![CDATA[
	       
		]]>
	</update>
	
	
	
	<!-- <select id="selectStfLogin" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
		SELECT *
		FROM Staff_tbl
	    WHERE stfLoginId = #{stfLoginId}
		]]>
	</select> -->
	
	<select id="selectStfLogin" parameterType="hashmap" resultType="net.admins.vo.Staff_VO">
		<![CDATA[
		SELECT *
		FROM Staff_tbl
	    WHERE stfLoginId = #{stfLoginId}
		]]>
	</select>
	<!-- <insert id="insertStfRegist" parameterType="hashmap" >
		insert into staff_tbl value(#{staff_id},#{stfLoginId},#{stfLoginPw},#{stfNumber},#{stfName},
		#{stfNickname},#{stfBranch},#{stfDeptName},#{stfClass},#{stfSubJobs},#{stfPhone},#{stfCellularP}
		,#{stfExtNbr},#{sftExtNbr},#{stfEmail},#{sftSsn1},#{sftSsn2},#{sftZipcode},#{sftAddress},#{sftMessengerName}
		,#{sftMessengerId},#{sftHomepage},#{sftMark},#{sftLevel},#{sftBusinessPic},#{sftAvataImage},#{sftData},#{sftPointAc}
		,#{sftJoinDt},#{sftDeleteDt},#{sftInserDt},#{sftUpdateDt},#{sftRecentLoginDt},#{sftIpAddress}
		)		
	</insert> -->

	<!-- 프로모터 리스트 -->
	<select id="selectPmtOneGetTotalCount" resultType="int">
	<![CDATA[
	   select count(*) from Promoter_tbl
	]]>
	</select>

	<select id="selectListPmtList" parameterType="hashmap" resultType="hashmap">
	<![CDATA[
	select c.* from (select @ROWNUM := @ROWNUM + 1 AS ROWNUM, a.* from (select * from Promoter_tbl order by promoter_id) a,  (SELECT @ROWNUM := 0) R ) c where c.ROWNUM >= #{startRow} and c.ROWNUM <= #{endRow}
	]]>
	</select>


	<select id="selectOnePmtLoginIdCheck" parameterType="string" resultType="int">
		<![CDATA[
	      SELECT Count(*) FROM Promoter_tbl WHERE pmtLoginId = #{pmtLoginId}
		]]>
	</select>

	<select id="selectPmtView" parameterType="string" resultType="hashmap">
		<![CDATA[
	      SELECT * FROM Promoter_tbl WHERE promoter_id = #{promoter_id}
		]]>
	</select>

	<insert id="insertPmtForm" parameterType="hashmap">
		<![CDATA[
		INSERT INTO Promoter_tbl (promoter_id, pmtLoginId, pmtLoginPw, pmtName, pmtGender, pmtNickName
						, pmtCellularPhone, pmtMail, pmtZipcode, pmtAddress, pmtAddressDetail, pmtMark)
		VALUES((SELECT IFNULL(max(pmt.promoter_id)+1,100000) FROM Promoter_tbl pmt), #{pmtLoginId}, #{pmtLoginPw}, #{pmtName}, #{pmtGender}, #{pmtNickname}
								, #{pmtCellularP}, #{pmtEmail}, #{pmtZipcode}, #{pmtAddress}, #{pmtAddressDetail}, #{pmtMark})
		]]>
	</insert>

	<insert id="insertPromoterValue_tbl" parameterType="hashmap">
		<![CDATA[
			INSERT INTO PromoterValue_tbl(promoter_id, pmtLevel, pmtVisitNbr, pmtEffects, pmtProfits, Promoter_tbl_promoter_id)
			SELECT promoter_id, 2, 0, 0, 0, promoter_id
			FROM Promoter_tbl
			WHERE pmtLoginId = #{pmtLoginId}
		]]>
	</insert>

	<insert id="insertPromoterValueLog_tbl" parameterType="hashmap">
		<![CDATA[
			INSERT INTO PromoterValueLog_tbl(promoterValueLog_id, promoter_id, pvlChagedPoint, pvlRemark, pvlInsertDt, pvlIpAddress, PromoterValue_tbl_promoter_id)
			SELECT (SELECT IFNULL(MAX(promoterValueLog_id)+1, 10000000) FROM PromoterValueLog_tbl), promoter_id, 0, #{pvlRemark}, NOW(), #{pvlIpAddress}, promoter_id
			FROM Promoter_tbl
			WHERE pmtLoginId = #{pmtLoginId}
		]]>
	</insert>

	<insert id="insertPromoterSpecialty_tbl" parameterType="hashmap">
		<![CDATA[
			INSERT INTO PromoterSpecialty_tbl(promoterSpecialty_id, Promoter_tbl_promoter_id)
			SELECT (SELECT IFNULL(MAX(promoterSpecialty_id)+1, 1000000) FROM PromoterSpecialty_tbl), promoter_id
			FROM Promoter_tbl
			WHERE pmtLoginId = #{pmtLoginId}
		]]>
	</insert>

	<insert id="insertPromoterLicense_tbl" parameterType="hashmap">
		<![CDATA[
			INSERT INTO PromoterLicense_tbl(promoter_id, pmtCompany, pmtBizLicenseNo, pmtBizType, Promoter_tbl_promoter_id)
			SELECT promoter_id, #{pmtCompany}, #{pmtBizLicenseNo}, #{pmtBizType}, promoter_id
			FROM Promoter_tbl
			WHERE pmtLoginId = #{pmtLoginId}
		]]>
	</insert>

	<insert id="insertPromoterChannel_tbl" parameterType="hashmap">
		<![CDATA[
			INSERT INTO PromoterChannel_tbl(promoterChannel_id, promoter_id, pmtChannelId, pmtChannelName, pmtChannelDesc, pmtChannelURL, pmtChannelMember, pmtChannelDaillyVisit, Promoter_tbl_promoter_id)
			SELECT (SELECT IFNULL(MAX(promoterChannel_id)+1, 100000) FROM PromoterChannel_tbl), promoter_id, #{pmtChannelId}, #{pmtChannelName}, #{pmtChannelDesc}, #{pmtChannelURL}, #{pmtChannelMember}, #{pmtChannelDaillyVisit}, promoter_id
			FROM Promoter_tbl
			WHERE pmtLoginId = #{pmtLoginId}
		]]>
	</insert>

	<insert id="insertPromoterAccount_tbl" parameterType="hashmap">
		<![CDATA[
			INSERT INTO PromoterAccount_tbl(promoter_id, pmtBankName, pmtBankAccount, Promoter_tbl_promoter_id)
			SELECT promoter_id, #{pmtBankName}, #{pmtBankAccount}, promoter_id
			FROM Promoter_tbl
			WHERE pmtLoginId = #{pmtLoginId}
		]]>
	</insert>
</mapper>

